

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Virtual host &mdash; envoy 1.5.0-tag-vtest_docs_tag3 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="envoy 1.5.0-tag-vtest_docs_tag3 documentation" href="../../../index.html"/>
        <link rel="up" title="Route configuration" href="route_config.html"/>
        <link rel="next" title="Route" href="route.html"/>
        <link rel="prev" title="Route configuration" href="route_config.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                1.5.0-tag-vtest_docs_tag3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/install.html">Building and installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../configuration.html">Configuration reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../overview/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../network_filters/network_filters.html">Network filters</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../http_conn_man.html">HTTP connection manager</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="route_config.html">Route configuration</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Virtual host</a></li>
<li class="toctree-l4"><a class="reference internal" href="route.html">Route</a></li>
<li class="toctree-l4"><a class="reference internal" href="vcluster.html">Virtual cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="rate_limits.html">Rate limit configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="route_matching.html">Route matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="traffic_splitting.html">Traffic Shifting/Splitting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../filters.html">Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing.html">Tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../headers.html">HTTP header manipulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../header_sanitizing.html">HTTP header sanitizing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats.html">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../runtime.html">Runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rds.html">Route discovery service</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../http_filters/http_filters.html">HTTP filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cluster_manager/cluster_manager.html">Cluster manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../access_log.html">Access logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/router_check.html">Route table check tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/api.html">Envoy v2 API reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../configuration.html">Configuration reference</a> &raquo;</li>
        
          <li><a href="../http_conn_man.html">HTTP connection manager</a> &raquo;</li>
        
          <li><a href="route_config.html">Route configuration</a> &raquo;</li>
        
      <li>Virtual host</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/configuration/http_conn_man/route_config/vhost.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="virtual-host">
<span id="config-http-conn-man-route-table-vhost"></span><h1>Virtual host<a class="headerlink" href="#virtual-host" title="Permalink to this headline">¶</a></h1>
<p>The top level element in the routing configuration is a virtual host. Each virtual host has
a logical name as well as a set of domains that get routed to it based on the incoming request’s
host header. This allows a single listener to service multiple top level domain path trees. Once a
virtual host is selected based on the domain, the routes are processed in order to see which
upstream cluster to route to or whether to perform a redirect.</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;domains&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;routes&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;require_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;virtual_clusters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;rate_limits&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;request_headers_to_add&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils">
<dt>name</dt>
<dd><em>(required, string)</em> The logical name of the virtual host. This is used when emitting certain
statistics but is not relevant for forwarding. By default, the maximum length of the name is
limited to 60 characters. This limit can be increased by setting the
<a class="reference internal" href="../../../operations/cli.html#cmdoption-max-obj-name-len"><code class="xref std std-option docutils literal"><span class="pre">--max-obj-name-len</span></code></a> command line argument to the desired value.</dd>
<dt>domains</dt>
<dd><em>(required, array)</em> A list of domains (host/authority header) that will be matched to this
virtual host. Wildcard hosts are supported in the form of “*.foo.com” or “*-bar.foo.com”.
Note that the wildcard will not match the empty string. e.g. “*-bar.foo.com” will match
“baz-bar.foo.com” but not “-bar.foo.com”.  Additionally, a special entry “*” is allowed
which will match any host/authority header.  Only a single virtual host in the entire route
configuration can match on “*”.  A domain must be unique across all virtual hosts or the config
will fail to load.</dd>
<dt><a class="reference internal" href="route.html#config-http-conn-man-route-table-route"><span class="std std-ref">routes</span></a></dt>
<dd><em>(required, array)</em> The list of routes that will be matched, in order, for incoming requests.
The first route that matches will be used.</dd>
<dt><a class="reference internal" href="../../http_filters/cors_filter.html#config-http-filters-cors"><span class="std std-ref">cors</span></a></dt>
<dd><em>(optional, object)</em> Specifies the virtual host’s CORS policy.</dd>
</dl>
<dl class="docutils" id="config-http-conn-man-route-table-vhost-require-ssl">
<dt>require_ssl</dt>
<dd><p class="first"><em>(optional, string)</em> Specifies the type of TLS enforcement the virtual host expects. Possible
values are:</p>
<dl class="docutils">
<dt>all</dt>
<dd>All requests must use TLS. If a request is not using TLS, a 302 redirect will be sent telling
the client to use HTTPS.</dd>
<dt>external_only</dt>
<dd>External requests must use TLS. If a request is external and it is not using TLS, a 302 redirect
will be sent telling the client to use HTTPS.</dd>
</dl>
<p class="last">If this option is not specified, there is no TLS requirement for the virtual host.</p>
</dd>
<dt><a class="reference internal" href="vcluster.html#config-http-conn-man-route-table-vcluster"><span class="std std-ref">virtual_clusters</span></a></dt>
<dd><em>(optional, array)</em> A list of virtual clusters defined for this virtual host. Virtual clusters
are used for additional statistics gathering.</dd>
<dt><a class="reference internal" href="rate_limits.html#config-http-conn-man-route-table-rate-limit-config"><span class="std std-ref">rate_limits</span></a></dt>
<dd><em>(optional, array)</em> Specifies a set of rate limit configurations that will be applied to the
virtual host.</dd>
</dl>
<dl class="docutils" id="config-http-conn-man-route-table-vhost-add-req-headers">
<dt>request_headers_to_add</dt>
<dd><p class="first"><em>(optional, array)</em> Specifies a list of HTTP headers that should be added to each
request handled by this virtual host. Headers are specified in the following form:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span><span class="nt">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;header1&quot;</span><span class="p">,</span> <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="nt">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;header2&quot;</span><span class="p">,</span> <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p class="last"><em>Note:</em> In the presence of duplicate header keys,
<a class="reference internal" href="route.html#config-http-conn-man-route-table-route-add-req-headers"><span class="std std-ref">precendence rules</span></a> apply.</p>
</dd>
</dl>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="route.html" class="btn btn-neutral float-right" title="Route" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="route_config.html" class="btn btn-neutral" title="Route configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2017, Envoy Project Authors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.5.0-tag-vtest_docs_tag3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>