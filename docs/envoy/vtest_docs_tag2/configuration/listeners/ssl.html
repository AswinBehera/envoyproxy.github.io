

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TLS context &mdash; envoy 1.5.0-320b5a documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="envoy 1.5.0-320b5a documentation" href="../../index.html"/>
        <link rel="up" title="Listeners" href="listeners.html"/>
        <link rel="next" title="Statistics" href="stats.html"/>
        <link rel="prev" title="Filters" href="filters.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                1.5.0-320b5a
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/install.html">Building and installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../configuration.html">Configuration reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="listeners.html">Listeners</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">TLS context</a></li>
<li class="toctree-l3"><a class="reference internal" href="stats.html">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="runtime.html">Runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="lds.html">Listener discovery service</a></li>
<li class="toctree-l3"><a class="reference internal" href="listeners.html#statistics">Statistics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../network_filters/network_filters.html">Network filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../http_conn_man/http_conn_man.html">HTTP connection manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../http_filters/http_filters.html">HTTP filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cluster_manager/cluster_manager.html">Cluster manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../access_log.html">Access logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/router_check.html">Route table check tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/api.html">Envoy v2 API reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">envoy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../configuration.html">Configuration reference</a> &raquo;</li>
        
          <li><a href="listeners.html">Listeners</a> &raquo;</li>
        
      <li>TLS context</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/configuration/listeners/ssl.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tls-context">
<span id="config-listener-ssl-context"></span><h1>TLS context<a class="headerlink" href="#tls-context" title="Permalink to this headline">¶</a></h1>
<p>TLS <a class="reference internal" href="../../intro/arch_overview/ssl.html#arch-overview-ssl"><span class="std std-ref">architecture overview</span></a>.</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;cert_chain_file&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;private_key_file&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;alpn_protocols&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;alt_alpn_protocols&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;ca_cert_file&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;verify_certificate_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;verify_subject_alt_name&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;cipher_suites&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;ecdh_curves&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;session_ticket_key_paths&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils">
<dt>cert_chain_file</dt>
<dd><em>(required, string)</em> The certificate chain file that should be served by the listener.</dd>
<dt>private_key_file</dt>
<dd><em>(required, string)</em> The private key that corresponds to the certificate chain file.</dd>
<dt>alpn_protocols</dt>
<dd><p class="first"><em>(optional, string)</em> Supplies the list of ALPN protocols that the listener should expose. In
practice this is likely to be set to one of two values (see the
<a class="reference internal" href="../http_conn_man/http_conn_man.html#config-http-conn-man-codec-type"><span class="std std-ref">codec_type</span></a> parameter in the HTTP connection
manager for more information):</p>
<ul class="last simple">
<li>“h2,http/1.1” If the listener is going to support both HTTP/2 and HTTP/1.1.</li>
<li>“http/1.1” If the listener is only going to support HTTP/1.1</li>
</ul>
</dd>
</dl>
<dl class="docutils" id="config-listener-ssl-context-alt-alpn">
<dt>alt_alpn_protocols</dt>
<dd><em>(optional, string)</em> An alternate ALPN protocol string that can be switched to via runtime. This
is useful for example to disable HTTP/2 without having to deploy a new configuration.</dd>
<dt>ca_cert_file</dt>
<dd><em>(optional, string)</em> A file containing certificate authority certificates to use in verifying
a presented client side certificate. If not specified and a client certificate is presented it
will not be verified. By default, a client certificate is optional, unless one of the additional
options (
<a class="reference internal" href="#config-listener-ssl-context-require-client-certificate"><span class="std std-ref">require_client_certificate</span></a>,
<a class="reference internal" href="#config-listener-ssl-context-verify-certificate-hash"><span class="std std-ref">verify_certificate_hash</span></a> or
<a class="reference internal" href="#config-listener-ssl-context-verify-subject-alt-name"><span class="std std-ref">verify_subject_alt_name</span></a>) is also
specified.</dd>
</dl>
<dl class="docutils" id="config-listener-ssl-context-require-client-certificate">
<dt>require_client_certificate</dt>
<dd><em>(optional, boolean)</em> If specified, Envoy will reject connections without a valid client certificate.</dd>
</dl>
<dl class="docutils" id="config-listener-ssl-context-verify-certificate-hash">
<dt>verify_certificate_hash</dt>
<dd><em>(optional, string)</em> If specified, Envoy will verify (pin) the hash of the presented client
side certificate.</dd>
</dl>
<dl class="docutils" id="config-listener-ssl-context-verify-subject-alt-name">
<dt>verify_subject_alt_name</dt>
<dd><em>(optional, array)</em> An optional list of subject alt names. If specified, Envoy will verify
that the client certificate’s subject alt name matches one of the specified values.</dd>
<dt>cipher_suites</dt>
<dd><em>(optional, string)</em> If specified, the TLS listener will only support the specified <a class="reference external" href="https://commondatastorage.googleapis.com/chromium-boringssl-docs/ssl.h.html#Cipher-suite-configuration">cipher list</a>.
If not specified, the default list:</dd>
</dl>
<div class="highlight-none"><div class="highlight"><pre><span></span>[ECDHE-ECDSA-AES128-GCM-SHA256|ECDHE-ECDSA-CHACHA20-POLY1305]
[ECDHE-RSA-AES128-GCM-SHA256|ECDHE-RSA-CHACHA20-POLY1305]
ECDHE-ECDSA-AES128-SHA256
ECDHE-RSA-AES128-SHA256
ECDHE-ECDSA-AES128-SHA
ECDHE-RSA-AES128-SHA
AES128-GCM-SHA256
AES128-SHA256
AES128-SHA
ECDHE-ECDSA-AES256-GCM-SHA384
ECDHE-RSA-AES256-GCM-SHA384
ECDHE-ECDSA-AES256-SHA384
ECDHE-RSA-AES256-SHA384
ECDHE-ECDSA-AES256-SHA
ECDHE-RSA-AES256-SHA
AES256-GCM-SHA384
AES256-SHA256
AES256-SHA
</pre></div>
</div>
<p>will be used.</p>
<dl class="docutils">
<dt>ecdh_curves</dt>
<dd><em>(optional, string)</em> If specified, the TLS connection will only support the specified ECDH curves.
If not specified, the default curves (X25519, P-256) will be used.</dd>
<dt>session_ticket_key_paths</dt>
<dd><p class="first"><em>(optional, array)</em> Paths to keyfiles for encrypting and decrypting TLS session tickets. The
first keyfile in the array contains the key to encrypt all new sessions created by this context.
All keys are candidates for decrypting received tickets. This allows for easy rotation of keys
by, for example, putting the new keyfile first, and the previous keyfile second.</p>
<p>If <cite>session_ticket_key_paths</cite> is not specified, the TLS library will still support resuming
sessions via tickets, but it will use an internally-generated and managed key, so sessions cannot
be resumed across hot restarts or on different hosts.</p>
<p>Each keyfile must contain exactly 80 bytes of cryptographically-secure random data.  For example,
the output of <code class="docutils literal"><span class="pre">openssl</span> <span class="pre">rand</span> <span class="pre">80</span></code>.</p>
<div class="last admonition attention">
<p class="first admonition-title">Attention</p>
<p>Using this feature has serious security considerations and risks. Improper handling of keys may
result in loss of secrecy in connections, even if ciphers supporting perfect forward secrecy
are used. See <a class="reference external" href="https://www.imperialviolet.org/2013/06/27/botchingpfs.html">https://www.imperialviolet.org/2013/06/27/botchingpfs.html</a> for some discussion.
To minimize the risk, you must:</p>
<ul class="last simple">
<li>Keep the session ticket keys at least as secure as your TLS certificate private keys</li>
<li>Rotate session ticket keys at least daily, and preferably hourly</li>
<li>Always generate keys using a cryptographically-secure random data source</li>
</ul>
</div>
</dd>
</dl>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="stats.html" class="btn btn-neutral float-right" title="Statistics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="filters.html" class="btn btn-neutral" title="Filters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2017, Lyft.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.5.0-320b5a',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>